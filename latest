# shellcheck shell=sh # xrc

# author:       Li Junhao           l@x-cmd.com

# Section: modules included
xrc param/latest

xrc yanfa/lib/all

xrc yanfa/lib/ws
xrc yanfa/lib/mod
xrc yanfa/lib/pkg

xrc yanfa/lib/init
xrc yanfa/lib/try

# EndSection

# git config --worktree --get-regexp "remote[a-z\.]+.url"

___x_cmd_yanfa(){
    param:dsl <<A
subcommand:
    init        "init"
    mod         "modules"
    pkg         "package"
    ws          "workspace"
    all         "all modules"
    try         "do some experiment on all poxis shell"
A
    param:run

    if [ -z "${PARAM_SUBCMD}" ]; then
        ___x_cmd_yanfa help
        return 0
    fi

    "___x_cmd_yanfa_${PARAM_SUBCMD}" "$@"
}

alias xdev="x dev"

# Section: git

# TODO: we will find a more suitable place for the code below.

alias giss="git status -s"
alias gip="x dev ws pull"
alias giP="x dev ws push"
giam(){
    local msg="${1:-...}"
    shift
    if [ $# -eq 0 ]; then
        ( cd "$(x wsroot)" && git add . )
    else
        git add "$@"
    fi
    git commit -m "$msg"
}

# EndSection

xrc setmain ___x_cmd_yanfa
